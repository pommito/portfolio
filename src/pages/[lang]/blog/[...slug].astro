---
import Tag from '@/components/ui/Tag.astro';
import Layout from '@/layouts/Layout.astro';
import { getCollection, render } from 'astro:content';

export async function getStaticPaths() {
  const pages = await getCollection('blog');

  const paths = pages.map(page => {
    const [lang, ...slug] = page.id.split('/');
    return { params: { lang, slug: slug.join('/') || undefined }, props: page };
  });

  return paths;
}

const { lang, slug } = Astro.params;
const page = Astro.props;

const { title, date, tags } = page.data;

const formatedDate = new Date(date).toLocaleDateString(lang, { year: 'numeric', month: 'long', day: 'numeric' });
const { Content } = await render(page);
---

<Layout
  title={`${title}・Victor Lebecq`}
  metaTitle={`${title}・Victor Lebecq`}
  metaDescription="TODO : Add a meta description to the articles"
>
  <h1 class="text-2xl">{title}</h1>
	<h4 class="text-neutral-500">Published {formatedDate}</h4>
  <ul class="space-x-2 mt-2">
    {tags.map((tag) => (
      <Tag label={tag} />
    ))}
  </ul>

  <div id="article-content" class="group mt-12 sm:mt-16">
    <Content  />
	</div>
</Layout>
